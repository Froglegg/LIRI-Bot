<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="">
</head>

<body>


    <script>
        // require("dotenv").config();
        var keys = require("./keys");
        var Spotify = require('node-spotify-api');
        var spotify = new Spotify(keys.spotify);
        var inquirer = require('inquirer');

        spotify.search({
            type: 'track',
            query: 'All the Small Things'
        }, function(err, data) {
            if (err) {
                return console.log('Error occurred: ' + err);
            }

            console.log(data);
        });

        var action = process.argv[2];
        var object = process.argv[3];

        var confirm = [{
            type: 'confirm',
            name: 'name',
            message: "Do you understand how to use LIRI bot?",
        }]

        function introduction() {
            console.log("=========================\nWelcome to LIRI bot! You need to enter one of the following commands + an object:\n1. `concert-this [some band name]` will tell LIRI to search the bands-in-town API for the band you pass in and return band information, concert dates, etc.\n2. `spotify-this-song [some song name]` will tell LIRI to search the spotify API and return information about the song you pass in.\n3. `movie-this [some movie name]` will tell LIRI to search the OMDB API for the movie you pass in and return movie information.\n4. `do-what-it-says [path to .txt file with instructions for LIRI]` will tell LIRI to execute whatever is in the .txt file you specify. The instructions in the .txt file must follow the format of one of the above commands, and contain no spaces or whitespace.\n\n=========================\nTry this: type `node liri.js concert-this deerhunter`");
        }

        if (action && object) {
            switch (`${action} ${object}`) {
                case `concert-this ${object}`:
                    console.log(`run bands in town for ${object}`);
                    spotify.search({
                        type: 'track',
                        query: object,
                        limit: 3
                    }, function(err, data) {
                        if (err) {
                            return console.log('Error occurred: ' + err);
                        }

                        console.log(data.tracks);
                    });
                    break;
                case `spotify-this-song ${object}`:
                    console.log("run spotify");
                    break;
                case `movie-this ${object}`:
                    console.log("run movies");
                    break;
                case `do-what-it-says ${object}`:
                    console.log("run dwis");
                    break;
                default:
                    console.log(`sorry, i dont understand ${action} ${object}`);
                    inquirer.prompt(confirm).then(answer => {
                        if (answer.name === true) {
                            console.log("well if you know how to use LIRI why don't you use it correctly this time...")
                        } else {
                            console.log('\n');
                            console.log("Read the introduction below and get learnt.")
                            console.log('\n');
                            introduction();
                        }
                    });
            }
        } else {
            introduction();
        }
    </script>
</body>

</html>